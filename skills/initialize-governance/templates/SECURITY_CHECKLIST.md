# Security Checklist

> Use this checklist before committing code to ensure security best practices are followed.

## Pre-Commit Security Verification

### Secrets and Credentials

- [ ] No hardcoded API keys, tokens, or passwords in code
- [ ] No credentials in configuration files (use environment variables)
- [ ] No private keys or certificates committed
- [ ] `.gitignore` includes sensitive file patterns (`.env`, `*.pem`, `*.key`)
- [ ] No secrets in commit messages or comments

### Environment Variables

- [ ] Sensitive configuration uses environment variables
- [ ] `.env.example` exists with placeholder values (no real secrets)
- [ ] Production secrets are managed via secure secret management
- [ ] Environment variable names don't leak information

### API Keys and Tokens

- [ ] API keys have minimal required permissions
- [ ] API keys are rotated on regular schedule
- [ ] No API keys in client-side/frontend code
- [ ] Rate limiting and quota alerts configured

### Authentication and Authorization

- [ ] Password hashing uses modern algorithms (bcrypt, Argon2)
- [ ] Session tokens are cryptographically random
- [ ] JWT tokens have appropriate expiration
- [ ] Authorization checks on all protected endpoints

### Data Protection

- [ ] PII (Personally Identifiable Information) is encrypted at rest
- [ ] Data in transit uses TLS 1.2+
- [ ] Sensitive data is not logged
- [ ] Data retention policies are followed

### Input Validation

- [ ] All user inputs are validated and sanitized
- [ ] SQL queries use parameterized statements
- [ ] File uploads are validated and sandboxed
- [ ] URLs and paths are validated to prevent traversal

### Dependencies

- [ ] No known vulnerable dependencies (`npm audit`, `pip-audit`, etc.)
- [ ] Dependencies are pinned to specific versions
- [ ] Dependency updates are reviewed before merging

## Code Review Security Points

When reviewing code, verify:

1. **No new secrets introduced**
2. **Input validation for all new endpoints**
3. **Authorization checks present**
4. **Error messages don't leak sensitive info**
5. **Logging doesn't include PII/secrets**

## Emergency Response

If secrets are accidentally committed:

1. **Immediately rotate the exposed secret**
2. Remove from git history: `git filter-branch` or BFG Repo Cleaner
3. Force push clean history
4. Audit access logs for unauthorized use
5. Document incident in security log

## Automated Checks

The following should be automated via git hooks or CI:

- [ ] Secret scanning (GitLeaks, TruffleHog)
- [ ] Dependency vulnerability scanning
- [ ] Static security analysis (SAST)
- [ ] Container image scanning

## Resources

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CWE/SANS Top 25](https://cwe.mitre.org/top25/)
- [GitHub Security Advisories](https://github.com/advisories)

---

*Last reviewed: {{GENERATED_DATE}}*
*Generated by wrangler git-hooks framework*
